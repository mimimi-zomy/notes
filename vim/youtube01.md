# [ほんとうに怖くない Vim 入門](https://www.youtube.com/live/2iVxqaK7lsk?feature=share)
## はじめに
- Vimはターミナルのなかで使用するエディタなので、とっつきにくいと思うが、実はそんなことはない。
- Vimに親近感を持ってもらえるようにと、動画を作った。
- Vimはエンジニアならなにかしらの形で使うため、ぜひ慣れてもらいたい。

## Vimを使うために必要な２つのこと
- タッチ・タイピング
  - （vimに限った話ではないが）絶対習得しておいたほうが良い。
  - Vimはマウスを使用しないエディタであるため、キーの場所が良くわからない状態だと、前途多難。
  - タッチ・タイピングで気をつけることは、特にHOMEポジションから動けるようにしておくこと。
- 矢印キーを捨てる勇気
  - Vimでも矢印キーは使えはするが、基本的には使わないようにすることが効率的にVimを使用する第一歩。

## Vim 代表的な4つのモード
1. ノーマルモード：デフォルト。カーソル移動など。`ESC`。
2. 挿入モード：文字の入力ができる。`i`や`a`など。
3. ヴィジュアルモード：文字を範囲選択できる。`v`や`Ctrl-v`など。
4. コマンドモード：検索や各種機能を使う。`:`や`/`など。
- 他エディタとの一番大きな違いは、通常のエディタは起動後すぐに文字入力などができるが、Vimはすぐの文字入力はできない。
- （一番はじめ、「挿入モード」を選択していない時点ではカーソルの移動などしかできない）
### モードが分かれているメリットは？
- 変更の範囲をコントロールできる
1. iで挿入モードに入って「I love」と入力してESCでノーマルモードに戻る。
  - `i` I love `ESC` →　**I love**
2. 1で`ESC`を押したためノーマルモードに戻っているので、再度iで挿入モードに切り替え、「code.」を追加する。
  - `i` code. `ESC` → **I love code.**
3. uで直前の変更を取り消すことができるため、「code.」を入力する前の状態に戻すことが可能。
  - `u` → **I love**
- こうした一見面倒にも見える操作でVimが便利な点は
  - モードの切り替えをすることで、変更の範囲をコントロールすることができる。これは他のエディタにはない特徴。
  - モード切替操作によって自分で範囲の指定ができるため、「この単位で作業したいな」という意図をテキストに反映させることが可能。
  - Vimは繰り返しを自動化するのも得意で、自動化の範囲をコントロールすることで効率的に編集ができる。（繰り返しについては後述）

## とりあえずVimの終わらせ方
- 意図せずVimが起動しても、慌てず終了させるコマンド `:q`
### 終わらせ方は複数ある
|コマンド|保存|内容を変更している|
|:---|:--|:-----------|
|`:q`|しない|警告が出る|
|`:q!`|しない|警告を無視して閉じる|

|コマンド|保存|タイムスタンプ|
|:---|:--|:--------|
|`:wq`|する|ファイル内容を更新していなくても、タイムスタンプは更新される。|
|`:x`|する|ファイル内容を更新していなければ、タイムスタンプは更新されない。|
|`ZZ`|する|ファイル内容を更新していなければ、タイムスタンプは更新されない。|

## カーソルの移動
### Vimはカーソルをhjklで操作
- カーソルキーでも移動は可能だが、ホームポジションの位置にあるhjklを使用した方が高速に操作ができる。
|キー|移動方向|矢印|
|:--|:------|:--|
|`k`|上|↑|
|`j`|下|↓|
|`l`|右|→|
|`h`|左|←|
#### キーボード設定を変えて高速化
- Macの方は、環境設定で 「**キーボードの設定**」で
  「**キーのリピート**」と「**リピート入力認識までの時間**」を両方Maxまで上げると、操作性がより向上する。
  - 例：`l`で右に移動する際、この設定をすれば高速にカーソルが移動できる。
#### 指定回数、繰り返せる
- カーソルを右に5文字文移動させるには`l`を5回タイプする
- また`5l`と入力しても`l`を5回入力したことになり、上記同様の操作になる。
- この操作は`l`などのカーソル移動の操作だけでなく、他のキー入力時にも使用可能。
- ただ、何文字先に移動したいか数えるほうが手間な場合もあるため、場面によっての使い分けが必須。
### 効率的なカーソル移動
#### 左右への動き
|キー|移動位置|
|:--|:------|
|`w`|次の単語の文頭へ移動|
|`b`|前の単語の文頭へ移動|
|`^`|現在指定している行の行頭へ移動|
|`$`|現在指定している行の行末へ移動|
#### 上下への動き
|コマンド|移動位置|
|:--|:------|
|`gg`|ページの先頭に移動|
|`G`|ページの最後へ移動|
|`10 Shift-g`|現在地より10行下へ移動|
|`Shift-g`|最終行へ移動|
#### n行移動する際は相対行表示をすると便利
- `:set relativenumber`コマンドを使用すると、
  カーソル位置からの相対的な行数を表示してくれるため、
  `Shift+n`の指定が直感的に行いやすくなる。
#### 折り返しの中で上下移動
`j`や`k`は改行単位での行移動だが、`g`を前につけると見た目上の行移動が可能になる。
### 基本のページ移動
|コマンド|移動位置|
|:--|:------|
|`Ctrl-b`|約1画面分上に移動する|
|`Ctrl-f`|約1画面分下に移動する|
### 効率的なページ移動
|コマンド|移動位置|
|:--|:------|
|`Ctrl-u`|約1/2画面分上に移動する|
|`Ctrl-d`|約1/2画面分下に移動する|
|`Ctrl-h`|画面上の一番上にカーソル移動|
|`Ctrl-m`|画面上の真ん中にカーソル移動|
|`Ctrl-l`|画面上の一番下にカーソル移動|
|`zz`|カーソル位置を画面の真ん中までスクロールする|
### 検索
#### / スラッシュで検索コマンド
- `/`の後に指定した文字が検索される : `/love`
- `n`を押すと次の検索候補に移動する
- `Shift-n`を押すと、前の検索候補に移動
#### 行の中で文字検索して移動
- `f`のあとに移動したい文字（例えば`e`）を入力すると、移動したい文字（`e`）に移動する
- `;`を打つと、次にヒットする文字へ移動
- `,`を打つと、前にヒットする文字へ移動
#### カーソル位置の単語を検索
- カーソルが「**code**」という文字にあった場合、`*`を押すとカーソル位置にある文字（この場合は**code**）を検索することが可能
- `n`を押すと次の検索候補に移動

## 文字の入力
### 代表的な文字入力

|コマンド|文字入力位置|
|:--|:-----------|
|`i`|カーソル位置の前から文字挿入|
|`a`|カーソル位置の後ろから文字挿入|
|`I`|行頭から文字入力|
|`A`|行末から文字入力|

### 削除
|コマンド|文字入力位置|
|:--|:-----------|
|`x`|カーソル位置の1文字削除|
|`u`|直前の操作を取り消す|

### もっと便利な編集 オペレータとモーション
#### 単語を削除する
- `dw`：カーソル位置の単語を削除（`x`を連打しなくて楽）
  - `d`「オペレータ」削除 delete の**d**
  - `w`「モーション」単語指定wordの**w**
#### オペレータ + モーション例

|コマンド|組み合わせ|結果|
|:----|:--------|:--|
|`daw`|削除`d`+単語`aw`|カーソル位置の単語を削除|
|`ciw`|変更`c`+単語`aw`|カーソル位置の単語を削除し、挿入モードへ|
|`y$`|コピー`y`+行末`$`|行末までをコピー|
|`>j`|インデント`>`+次の行`j`|今と次の行をインデント|

ちなみにオペレータを２回繰り返すと、カーソル位置の行が対象範囲になる
- `dd`現在の行を削除
- `>>`現在の行をインデント

#### .で繰り返し
##### .は最後の変更を繰り返す
1. `dw`カーソル位置の単語を削除
2. `.`で直前の挙動を繰り返す
#### 置換
- `:%s/対象/置換/`：「対象」の部分に変更したい単語を、「置換」の部分に置き換えたい単語を入れて使用
  - 例：文章内の「love」を「like」に置換したい場合、`:%s/love/like/`
#### テキストオブジェクト
##### "や(){}で囲まれた文字を編集したい

|コマンド|結果|
|:----|:--|
|`va'`|''で囲まれた文字を選択する（''を含む）|
|`ci'`|''で囲まれた文字を消して挿入モードへ|

- 文字のかたまりがテキストオブジェクト
- その他のテキストオブジェクト（aかiが付く）

|コマンド|結果|
|:----|:--|
|`aw`|単語|
|`a"`|""|
|`a(`|()|
|`a{`|{}|
|`a[`|[]|
|`at`|タグ|

#### ビジュアルモード
##### ビジュアルモードは範囲指定できる

|コマンド|結果|
|:----|:--|
|`v`|ビジュアルモード（文字）|
|`V`|ビジュアルモード（行）|
|`Ctrl-v`|ビジュアルモード（矩形）|

- 全部コメントアウトしたい場合
  1. `Ctrl-v`+カーソル移動などで行頭などへ移動ののち選択をし、
  2.  `//`などでコメントアウトする
- 末尾にセミコロンをつけたい場合
  1. `Ctrl-v`+カーソル移動などで行選択+`$`で末尾まで移動をし、
  2. `Shift-A`をし、行末に対して入力モードをして、
  3. `;`を入力すると、選択した行すべての行末にセミコロンがつく





   
  
